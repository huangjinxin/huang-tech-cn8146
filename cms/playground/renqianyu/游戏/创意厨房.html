<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>åˆ›æ„å¨å¸ˆ - è‡ªç”±çƒ¹é¥ªæ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }
        
        header {
            background: #4a6572;
            color: white;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: relative;
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 14px;
            opacity: 0.8;
        }
        
        .gold-display {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #ffc107;
            color: #333;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        main {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .restaurant-name {
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .restaurant-name-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            text-align: center;
            font-weight: bold;
        }
        
        .restaurant-name-input:focus {
            outline: none;
            border-color: #4a6572;
        }
        
        .section-title {
            font-size: 20px;
            color: #4a6572;
            margin-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .ingredient-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .ingredients-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
        }
        
        .ingredient-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }
        
        .ingredient-item:hover:not(.locked) {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .ingredient-item.selected {
            border-color: #4a6572;
            background: #e9ecef;
        }
        
        .ingredient-item.paid {
            background: #fff3e0;
        }
        
        .ingredient-item.locked {
            opacity: 0.6;
            cursor: not-allowed;
            position: relative;
        }
        
        .ingredient-item.locked::after {
            content: 'ğŸ”’';
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 18px;
        }
        
        .ingredient-icon {
            width: 50px;
            height: 50px;
            margin: 0 auto 5px;
        }
        
        .ingredient-name {
            font-size: 14px;
            color: #495057;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .ingredient-price {
            font-size: 12px;
            color: #ff9800;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .buy-btn {
            background: #ff9800;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .buy-btn:hover:not(:disabled) {
            background: #f57c00;
            transform: scale(1.05);
        }
        
        .buy-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        
        .cooking-area {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .pot {
            width: 200px;
            height: 150px;
            background: #6d4c41;
            border-radius: 50% 50% 45% 45%;
            position: relative;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: inset 0 -5px 10px rgba(0,0,0,0.2);
        }
        
        .pot::before {
            content: '';
            position: absolute;
            top: 10px;
            left: -20px;
            right: -20px;
            height: 30px;
            background: #5d4037;
            border-radius: 50%;
        }
        
        .pot-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100%;
            background: linear-gradient(180deg, rgba(255,255,255,0.1) 0%, rgba(0,0,0,0.1) 100%);
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-end;
            padding: 10px;
        }
        
        .ingredient-in-pot {
            width: 30px;
            height: 30px;
            margin: 2px;
            animation: bob 2s infinite ease-in-out;
        }
        
        @keyframes bob {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        .cooking-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn-clear {
            background: #f44336;
            color: white;
        }
        
        .btn-clear:hover {
            background: #d32f2f;
            transform: scale(1.05);
        }
        
        .btn-cook {
            background: #4caf50;
            color: white;
        }
        
        .btn-cook:hover:not(:disabled) {
            background: #388e3c;
            transform: scale(1.05);
        }
        
        .btn-cook:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        
        .recipe-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .recipe-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 15px;
            transition: border-color 0.3s ease;
        }
        
        .recipe-input:focus {
            outline: none;
            border-color: #4a6572;
        }
        
        .rating-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .star {
            font-size: 30px;
            color: #ddd;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        
        .star.active {
            color: #ffc107;
        }
        
        .saved-recipes {
            margin-top: 30px;
        }
        
        .recipe-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .recipe-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .recipe-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-color: #4a6572;
        }
        
        .recipe-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 10px;
        }
        
        .recipe-name {
            font-size: 14px;
            font-weight: bold;
            color: #4a6572;
            margin-bottom: 5px;
        }
        
        .recipe-rating {
            color: #ffc107;
            font-size: 14px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 90%;
            width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            color: #999;
            cursor: pointer;
        }
        
        .close-modal:hover {
            color: #333;
        }
        
        .recipe-details h3 {
            color: #4a6572;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .recipe-ingredients {
            margin-bottom: 20px;
        }
        
        .ingredient-tag {
            display: inline-block;
            background: #e9ecef;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
            margin: 3px;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 2000;
        }
        
        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .notification.error {
            background: #f44336;
        }
        
        .customer-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .customer-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .customer {
            width: 120px;
            height: 120px;
            margin-bottom: 15px;
            position: relative;
        }
        
        .customer-message {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px 15px;
            margin-bottom: 15px;
            position: relative;
            max-width: 80%;
        }
        
        .customer-message::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 10px 10px 0;
            border-style: solid;
            border-color: #f8f9fa transparent transparent;
        }
        
        .customer-rating {
            display: flex;
            gap: 5px;
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        .customer-rating .star {
            cursor: default;
        }
        
        .customer-comment {
            font-style: italic;
            color: #666;
            margin-bottom: 10px;
        }
        
        .customer-earnings {
            background: #e8f5e9;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            width: 100%;
        }
        
        .earnings-value {
            font-size: 24px;
            font-weight: bold;
            color: #2e7d32;
        }
        
        .bonus-earnings {
            background: #fff3e0;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            width: 100%;
            margin-top: 10px;
        }
        
        .bonus-value {
            font-size: 24px;
            font-weight: bold;
            color: #e65100;
        }
        
        .serving-area {
            width: 100%;
            padding: 15px;
            background: #f1f8e9;
            border-radius: 10px;
            text-align: center;
        }
        
        .dish-plate {
            width: 100px;
            height: 30px;
            background: #eceff1;
            border-radius: 50%;
            margin: 0 auto 15px;
            position: relative;
            overflow: hidden;
        }
        
        .dish-content {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .btn-serve {
            background: #ff9800;
            color: white;
            width: 100%;
        }
        
        .btn-serve:hover:not(:disabled) {
            background: #f57c00;
        }
        
        .btn-serve:disabled {
            background: #cccccc;
        }
        
        .stats {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            text-align: center;
        }
        
        .stat-item {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #4a6572;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        .competition-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .competition-info {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .competition-title {
            font-size: 18px;
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .competition-theme {
            font-size: 16px;
            color: #424242;
            margin-bottom: 10px;
        }
        
        .competition-rules {
            font-size: 14px;
            color: #616161;
        }
        
        .competition-progress {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .competition-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #8bc34a);
            border-radius: 10px;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .competition-timer {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #f44336;
            margin-bottom: 20px;
        }
        
        .competition-results {
            display: none;
            margin-top: 20px;
        }
        
        .result-card {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .result-player {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .result-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .result-info {
            text-align: left;
        }
        
        .result-name {
            font-weight: bold;
            color: #424242;
        }
        
        .result-score {
            font-size: 14px;
            color: #757575;
        }
        
        .result-points {
            font-size: 20px;
            font-weight: bold;
            color: #4caf50;
        }
        
        .btn-competition {
            background: #2196f3;
            color: white;
            width: 100%;
            margin-top: 15px;
        }
        
        .btn-competition:hover:not(:disabled) {
            background: #1976d2;
        }
        
        .btn-competition:disabled {
            background: #cccccc;
        }
        
        .certificate-wall {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .certificate-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .certificate-count {
            background: #fff3e0;
            color: #e65100;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .certificate-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .certificate-item {
            background: #fff8e1;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .certificate-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .certificate-item::before {
            content: 'ğŸ†';
            position: absolute;
            top: -10px;
            right: -10px;
            font-size: 30px;
            opacity: 0.3;
        }
        
        .certificate-preview {
            height: 100px;
            background: white;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .certificate-restaurant {
            font-size: 12px;
            font-weight: bold;
            color: #d84315;
            margin-bottom: 5px;
        }
        
        .certificate-theme {
            font-size: 10px;
            color: #f57c00;
            margin-bottom: 5px;
        }
        
        .certificate-date {
            font-size: 9px;
            color: #795548;
        }
        
        .empty-wall {
            text-align: center;
            color: #999;
            padding: 40px;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .ingredients-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .pot {
                width: 150px;
                height: 120px;
            }
            
            .ingredient-in-pot {
                width: 25px;
                height: 25px;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .gold-display {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 15px;
            }
            
            header {
                padding: 10px;
            }
            
            .gold-display {
                position: absolute;
                top: 15px;
                right: 15px;
            }
            
            .competition-results {
                padding: 0 10px;
            }
            
            .result-card {
                padding: 10px;
            }
            
            .certificate-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>ğŸ³ åˆ›æ„å¨å¸ˆ</h1>
        <p class="subtitle">è‡ªç”±åˆ›ä½œç¾å‘³ï¼Œèµ¢å¾—é¡¾å®¢å¥½è¯„ï¼</p>
        <div class="gold-display">
            <span>ğŸ’°</span>
            <span id="goldAmount">100</span>
        </div>
    </header>
    
    <main>
        <div class="restaurant-name">
            <h2 class="section-title" style="margin-bottom: 10px;">ğŸª æˆ‘çš„é¥­åº—</h2>
            <input type="text" class="restaurant-name-input" id="restaurantNameInput" placeholder="è¯·è¾“å…¥æ‚¨çš„é¥­åº—åç§°..." value="ç¾å‘³å°å¨">
        </div>
        
        <section class="ingredient-section">
            <h2 class="section-title">ğŸ¥˜ é€‰æ‹©é£Ÿæ</h2>
            <div class="ingredients-grid" id="ingredientsGrid">
                <!-- é£Ÿæå°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
            </div>
        </section>
        
        <section class="cooking-area">
            <h2 class="section-title">ğŸ‘¨â€ğŸ³ çƒ¹é¥ªä¸­</h2>
            <div class="pot" id="cookingPot">
                <div class="pot-content" id="potContent"></div>
            </div>
            <div class="cooking-actions">
                <button class="btn btn-clear" id="clearBtn">æ¸…ç©ºé”…å­</button>
                <button class="btn btn-cook" id="cookBtn" disabled>å®Œæˆçƒ¹é¥ª</button>
            </div>
        </section>
        
        <section class="customer-section">
            <h2 class="section-title">ğŸ‘¥ é¡¾å®¢æœåŠ¡</h2>
            <div class="serving-area" id="servingArea">
                <p style="margin-bottom: 15px; color: #666;">çƒ¹é¥ªå®Œæˆåï¼Œä¸ºé¡¾å®¢æä¾›æ‚¨çš„ç¾é£Ÿï¼</p>
            </div>
            
            <div class="customer-area" id="customerArea" style="display: none;">
                <div class="customer">
                    <svg viewBox="0 0 100 100">
                        <circle cx="50" cy="45" r="30" fill="#ffccbc" />
                        <circle cx="40" cy="40" r="3" fill="#333" />
                        <circle cx="60" cy="40" r="3" fill="#333" />
                        <path d="M 40 55 Q 50 65 60 55" stroke="#333" stroke-width="2" fill="none" />
                        <ellipse cx="50" cy="80" rx="25" ry="35" fill="#4fc3f7" />
                    </svg>
                </div>
                
                <div class="customer-message" id="customerMessage">
                    <!-- é¡¾å®¢æ¶ˆæ¯å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                </div>
                
                <div class="customer-rating" id="customerRating">
                    <!-- é¡¾å®¢è¯„åˆ†å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                </div>
                
                <div class="customer-comment" id="customerComment">
                    <!-- é¡¾å®¢è¯„è®ºå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                </div>
                
                <div class="customer-earnings">
                    <div>è·å¾—é‡‘å¸</div>
                    <div class="earnings-value" id="earningsValue">0</div>
                </div>
                
                <div class="bonus-earnings" id="bonusEarnings" style="display: none;">
                    <div>å¥½è¯„å¥–åŠ±</div>
                    <div class="bonus-value" id="bonusValue">+10</div>
                </div>
                
                <button class="btn btn-cook" id="nextCustomerBtn" style="width: 100%; margin-top: 15px;">ä¸‹ä¸€ä½é¡¾å®¢</button>
            </div>
            
            <div class="stats">
                <h3 class="section-title">ğŸ“Š é¤å…ç»Ÿè®¡</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="totalEarnings">0</div>
                        <div class="stat-label">æ€»æ”¶å…¥</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="avgRating">0.0</div>
                        <div class="stat-label">å¹³å‡è¯„åˆ†</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="customersServed">0</div>
                        <div class="stat-label">æœåŠ¡é¡¾å®¢</div>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="competition-section">
            <h2 class="section-title">ğŸ† çƒ¹é¥ªå¤§èµ›</h2>
            <div class="competition-info" id="competitionInfo">
                <div class="competition-title">å‚åŠ çƒ¹é¥ªå¤§èµ›ï¼Œèµ¢å–è£èª‰å’Œå¥–åŠ±ï¼</div>
                <div class="competition-theme" id="competitionTheme">ç­‰å¾…æ¯”èµ›å¼€å§‹...</div>
                <div class="competition-rules" id="competitionRules">æ¯”èµ›è§„åˆ™å°†åœ¨å¼€å§‹æ—¶æ˜¾ç¤º</div>
            </div>
            
            <div class="competition-progress" id="competitionProgress" style="display: none;">
                <div class="competition-progress-bar" id="progressBar"></div>
            </div>
            
            <div class="competition-timer" id="competitionTimer" style="display: none;">
                æ¯”èµ›æ—¶é—´ï¼š60ç§’
            </div>
            
            <div class="competition-results" id="competitionResults">
                <h3 style="margin-bottom: 15px; color: #4a6572;">æ¯”èµ›ç»“æœ</h3>
                <div id="resultsContainer"></div>
                
                <div class="certificate" id="certificate" style="display: none;">
                    <div class="certificate-title">è·å¥–è¯ä¹¦</div>
                    <div class="certificate-content">
                        æ­å–œæ‚¨åœ¨çƒ¹é¥ªå¤§èµ›ä¸­è·å¾—ä¼˜å¼‚æˆç»©ï¼<br>
                        æ‚¨çš„å¨è‰ºå¾—åˆ°äº†è¯„å§”ä»¬çš„ä¸€è‡´å¥½è¯„ï¼
                    </div>
                    <div class="certificate-restaurant" id="certificateRestaurant"></div>
                    <div class="certificate-date" id="certificateDate"></div>
                    <div class="certificate-signature">â€”â€” ç¾é£Ÿè¯„å®¡å›¢</div>
                </div>
            </div>
            
            <button class="btn btn-competition" id="startCompetitionBtn">å¼€å§‹æ¯”èµ›</button>
        </section>
        
        <section class="certificate-wall">
            <div class="certificate-header">
                <h2 class="section-title" style="margin-bottom: 0;">ğŸ… å¥–çŠ¶å±•ç¤ºå¢™</h2>
                <div class="certificate-count" id="certificateCount">0ä¸ªå¥–çŠ¶</div>
            </div>
            <div class="certificate-grid" id="certificateGrid">
                <div class="empty-wall">è¿˜æ²¡æœ‰è·å¾—ä»»ä½•å¥–çŠ¶ï¼Œå¿«å»å‚åŠ æ¯”èµ›å§ï¼</div>
            </div>
        </section>
        
        <section class="recipe-section">
            <h2 class="section-title">ğŸ’¾ ä¿å­˜æ‚¨çš„åˆ›ä½œ</h2>
            <input type="text" class="recipe-input" id="recipeName" placeholder="ä¸ºæ‚¨çš„ç¾å‘³èœè‚´å‘½å...">
            
            <div class="rating-container">
                <span>è¯„åˆ†:</span>
                <span class="star" data-rating="1">â˜…</span>
                <span class="star" data-rating="2">â˜…</span>
                <span class="star" data-rating="3">â˜…</span>
                <span class="star" data-rating="4">â˜…</span>
                <span class="star" data-rating="5">â˜…</span>
                <span id="ratingValue">0/5</span>
            </div>
            
            <button class="btn btn-cook" id="saveBtn" disabled>ä¿å­˜é£Ÿè°±</button>
            
            <div class="saved-recipes" id="savedRecipes">
                <h3 class="section-title">ğŸ“– æˆ‘çš„é£Ÿè°±</h3>
                <div class="recipe-list" id="recipeList">
                    <!-- ä¿å­˜çš„é£Ÿè°±å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                </div>
            </div>
        </section>
    </main>
    
    <div class="modal" id="recipeModal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <div class="recipe-details" id="recipeDetails">
                <!-- é£Ÿè°±è¯¦æƒ…å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
            </div>
        </div>
    </div>
    
    <div class="modal" id="certificateModal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close-modal" id="closeCertificateModal">&times;</span>
            <div class="certificate" id="certificateModalContent" style="display: block; padding: 40px;">
                <div class="certificate-title">è·å¥–è¯ä¹¦</div>
                <div class="certificate-content">
                    æ­å–œæ‚¨åœ¨çƒ¹é¥ªå¤§èµ›ä¸­è·å¾—ä¼˜å¼‚æˆç»©ï¼<br>
                    æ‚¨çš„å¨è‰ºå¾—åˆ°äº†è¯„å§”ä»¬çš„ä¸€è‡´å¥½è¯„ï¼
                </div>
                <div class="certificate-restaurant" id="certificateModalRestaurant"></div>
                <div class="certificate-date" id="certificateModalDate"></div>
                <div style="text-align: center; margin-top: 30px;">
                    <div style="display: inline-block; border: 2px solid #666; border-radius: 5px; padding: 10px; font-family: cursive; font-style: italic; font-size: 14px;">
                        ç¾é£Ÿè¯„å®¡å›¢ è£èª‰å‡ºå“
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <script>
        // é£Ÿææ•°æ®ï¼ˆæ·»åŠ ä»·æ ¼å±æ€§ï¼‰
        const ingredients = [
            { id: 'tomato', name: 'ç•ªèŒ„', color: '#ff5252', icon: 'ğŸ…', price: 0 },
            { id: 'carrot', name: 'èƒ¡èåœ', color: '#ff9800', icon: 'ğŸ¥•', price: 0 },
            { id: 'onion', name: 'æ´‹è‘±', color: '#ffeb3b', icon: 'ğŸ§…', price: 0 },
            { id: 'pepper', name: 'é’æ¤’', color: '#4caf50', icon: 'ğŸ«‘', price: 0 },
            { id: 'mushroom', name: 'è˜‘è‡', color: '#795548', icon: 'ğŸ„', price: 0 },
            { id: 'pork', name: 'çŒªè‚‰', color: '#f44336', icon: 'ğŸ¥©', price: 10 },
            { id: 'beef', name: 'ç‰›è‚‰', color: '#d32f2f', icon: 'ğŸ¥©', price: 15 },
            { id: 'chicken', name: 'é¸¡è‚‰', color: '#ffeb3b', icon: 'ğŸ—', price: 8 },
            { id: 'fish', name: 'é±¼', color: '#2196f3', icon: 'ğŸŸ', price: 12 },
            { id: 'egg', name: 'é¸¡è›‹', color: '#fff', icon: 'ğŸ¥š', price: 5 },
            { id: 'rice', name: 'ç±³é¥­', color: '#f5f5dc', icon: 'ğŸš', price: 0 },
            { id: 'noodle', name: 'é¢æ¡', color: '#f5f5dc', icon: 'ğŸœ', price: 0 },
            { id: 'potato', name: 'åœŸè±†', color: '#d7ccc8', icon: 'ğŸ¥”', price: 0 },
            { id: 'corn', name: 'ç‰ç±³', color: '#ffeb3b', icon: 'ğŸŒ½', price: 0 },
            { id: 'cheese', name: 'å¥¶é…ª', color: '#fff59d', icon: 'ğŸ§€', price: 10 },
            { id: 'garlic', name: 'å¤§è’œ', color: '#ffffff', icon: 'ğŸ§„', price: 0 },
            { id: 'shrimp', name: 'è™¾', color: '#f8bbd9', icon: 'ğŸ¦', price: 20 },
            { id: 'lobster', name: 'é¾™è™¾', color: '#ff8a65', icon: 'ğŸ¦', price: 30 },
            { id: 'caviar', name: 'é±¼å­é…±', color: '#7986cb', icon: 'ğŸ¥«', price: 50 },
            { id: 'truffle', name: 'æ¾éœ²', color: '#6d4c41', icon: 'ğŸ„', price: 40 }
        ];
        
        // æ¯”èµ›ä¸»é¢˜å’Œè§„åˆ™
        const competitionThemes = [
            {
                name: "æµ·é²œç››å®´",
                rules: "å¿…é¡»è‡³å°‘ä½¿ç”¨3ç§æµ·é²œé£Ÿæ",
                requiredIngredients: ['fish', 'shrimp', 'lobster'],
                scoreMultiplier: 1.5
            },
            {
                name: "ç´ é£Ÿç¾å­¦",
                rules: "åªèƒ½ä½¿ç”¨è”¬èœç±»é£Ÿæ",
                requiredIngredients: ['tomato', 'carrot', 'onion', 'pepper', 'mushroom'],
                scoreMultiplier: 1.3
            },
            {
                name: "è‚‰ç±»ç‹‚æ¬¢",
                rules: "å¿…é¡»è‡³å°‘ä½¿ç”¨2ç§è‚‰ç±»",
                requiredIngredients: ['pork', 'beef', 'chicken'],
                scoreMultiplier: 1.4
            },
            {
                name: "åˆ›æ„æ··æ­",
                rules: "ä½¿ç”¨è‡³å°‘5ç§ä¸åŒç±»å‹çš„é£Ÿæ",
                requiredIngredients: [],
                minIngredients: 5,
                scoreMultiplier: 1.6
            },
            {
                name: "ç»æµå®æƒ ",
                rules: "æ€»é£Ÿæä»·å€¼ä¸èƒ½è¶…è¿‡50é‡‘å¸",
                maxCost: 50,
                scoreMultiplier: 1.2
            }
        ];
        
        // AIå¨å¸ˆåå­—å’Œå¤´åƒ
        const aiChefs = [
            { name: "ç‹å¸ˆå‚…", avatar: "ğŸ‘¨â€ğŸ³" },
            { name: "æå¤§å¨", avatar: "ğŸ§‘â€ğŸ³" },
            { name: "å¼ ç¾é£Ÿ", avatar: "ğŸ‘©â€ğŸ³" }
        ];
        
        // é¡¾å®¢ç±»å‹å’Œåå¥½
        const customerTypes = [
            {
                name: 'ç¾é£Ÿå®¶',
                icon: 'ğŸ‘¨â€ğŸ³',
                preferences: ['rice', 'noodle', 'pork', 'beef', 'fish', 'shrimp', 'lobster', 'caviar'],
                message: 'æˆ‘æ˜¯ç¾é£Ÿå®¶ï¼ŒæœŸå¾…æ‚¨çš„æ°ä½œï¼',
                highExpectation: true,
                bonusThreshold: 4
            },
            {
                name: 'ç´ é£Ÿè€…',
                icon: 'ğŸ§‘â€ğŸŒ¾',
                preferences: ['tomato', 'carrot', 'onion', 'pepper', 'mushroom', 'potato', 'corn'],
                message: 'æˆ‘åªåƒè”¬èœï¼Œè¯·ä¸ºæˆ‘å‡†å¤‡ç´ é£Ÿæ–™ç†ã€‚',
                highExpectation: false,
                bonusThreshold: 3
            },
            {
                name: 'å„¿ç«¥',
                icon: 'ğŸ‘¶',
                preferences: ['egg', 'cheese', 'chicken', 'potato', 'corn'],
                message: 'æˆ‘è¦åƒå¥½åƒçš„ï¼ä¸è¦è¾£çš„å“¦~',
                highExpectation: false,
                bonusThreshold: 3
            },
            {
                name: 'å¥åº·è¾¾äºº',
                icon: 'ğŸƒâ€â™‚ï¸',
                preferences: ['fish', 'chicken', 'vegetable'],
                message: 'æˆ‘æ³¨é‡å¥åº·ï¼Œè¯·æ¸…æ·¡ä¸€äº›ã€‚',
                highExpectation: true,
                bonusThreshold: 4
            },
            {
                name: 'æ™®é€šé¡¾å®¢',
                icon: 'ğŸ‘¨â€ğŸ’¼',
                preferences: [],
                message: 'éšä¾¿æ¥ç‚¹å¥½åƒçš„å°±å¥½ï¼',
                highExpectation: false,
                bonusThreshold: 3
            }
        ];
        
        // æ¸¸æˆçŠ¶æ€
        let selectedIngredients = [];
        let currentRating = 0;
        let savedRecipes = JSON.parse(localStorage.getItem('savedRecipes')) || [];
        let currentDish = null;
        let restaurantStats = JSON.parse(localStorage.getItem('restaurantStats')) || {
            totalEarnings: 0,
            totalRating: 0,
            customersServed: 0
        };
        let ownedIngredients = JSON.parse(localStorage.getItem('ownedIngredients')) || [];
        let gold = parseInt(localStorage.getItem('gold')) || 100;
        let restaurantName = localStorage.getItem('restaurantName') || 'ç¾å‘³å°å¨';
        let competitionInProgress = false;
        let competitionTimer = null;
        let certificates = JSON.parse(localStorage.getItem('certificates')) || [];
        
        // DOMå…ƒç´ 
        const ingredientsGrid = document.getElementById('ingredientsGrid');
        const cookingPot = document.getElementById('cookingPot');
        const potContent = document.getElementById('potContent');
        const clearBtn = document.getElementById('clearBtn');
        const cookBtn = document.getElementById('cookBtn');
        const recipeNameInput = document.getElementById('recipeName');
        const ratingStars = document.querySelectorAll('.star');
        const ratingValue = document.getElementById('ratingValue');
        const saveBtn = document.getElementById('saveBtn');
        const recipeList = document.getElementById('recipeList');
        const recipeModal = document.getElementById('recipeModal');
        const closeModal = document.getElementById('closeModal');
        const recipeDetails = document.getElementById('recipeDetails');
        const notification = document.getElementById('notification');
        const servingArea = document.getElementById('servingArea');
        const customerArea = document.getElementById('customerArea');
        const customerMessage = document.getElementById('customerMessage');
        const customerRating = document.getElementById('customerRating');
        const customerComment = document.getElementById('customerComment');
        const earningsValue = document.getElementById('earningsValue');
        const bonusEarnings = document.getElementById('bonusEarnings');
        const bonusValue = document.getElementById('bonusValue');
        const nextCustomerBtn = document.getElementById('nextCustomerBtn');
        const goldAmount = document.getElementById('goldAmount');
        const restaurantNameInput = document.getElementById('restaurantNameInput');
        
        // æ¯”èµ›ç›¸å…³å…ƒç´ 
        const competitionInfo = document.getElementById('competitionInfo');
        const competitionTheme = document.getElementById('competitionTheme');
        const competitionRules = document.getElementById('competitionRules');
        const competitionProgress = document.getElementById('competitionProgress');
        const progressBar = document.getElementById('progressBar');
        const competitionTimerDisplay = document.getElementById('competitionTimer');
        const competitionResults = document.getElementById('competitionResults');
        const resultsContainer = document.getElementById('resultsContainer');
        const certificate = document.getElementById('certificate');
        const certificateRestaurant = document.getElementById('certificateRestaurant');
        const certificateDate = document.getElementById('certificateDate');
        const startCompetitionBtn = document.getElementById('startCompetitionBtn');
        
        // å¥–çŠ¶å¢™ç›¸å…³å…ƒç´ 
        const certificateWall = document.getElementById('certificateWall');
        const certificateGrid = document.getElementById('certificateGrid');
        const certificateCount = document.getElementById('certificateCount');
        const certificateModal = document.getElementById('certificateModal');
        const closeModalCertificateModal = document.getElementById('closeCertificateModal');
        const certificateModalContent = document.getElementById('certificateModalContent');
        const certificateModalRestaurant = document.getElementById('certificateModalRestaurant');
        const certificateModalDate = document.getElementById('certificateModalDate');
        
        // ç»Ÿè®¡å…ƒç´ 
        const totalEarnings = document.getElementById('totalEarnings');
        const avgRating = document.getElementById('avgRating');
        const customersServed = document.getElementById('customersServed');
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function init() {
            restaurantNameInput.value = restaurantName;
            renderIngredients();
            loadSavedRecipes();
            loadCertificateWall();
            updateStats();
            updateGoldDisplay();
            setupEventListeners();
        }
        
        // ä¿å­˜é¥­åº—åç§°
        function saveRestaurantName() {
            restaurantName = restaurantNameInput.value.trim() || 'ç¾å‘³å°å¨';
            localStorage.setItem('restaurantName', restaurantName);
            showNotification(`é¥­åº—åç§°å·²æ›´æ–°ä¸ºï¼š${restaurantName}`);
        }
        
        // æ¸²æŸ“é£Ÿæé€‰æ‹©å™¨
        function renderIngredients() {
            ingredientsGrid.innerHTML = '';
            ingredients.forEach(ingredient => {
                const ingredientEl = document.createElement('div');
                ingredientEl.className = 'ingredient-item';
                
                // æ£€æŸ¥æ˜¯å¦æ‹¥æœ‰è¯¥é£Ÿæ
                const isOwned = ownedIngredients.includes(ingredient.id);
                const isSelected = selectedIngredients.some(ing => ing.id === ingredient.id);
                
                if (!isOwned && ingredient.price > 0) {
                    ingredientEl.classList.add('locked');
                } else {
                    ingredientEl.addEventListener('click', () => toggleIngredient(ingredient.id));
                }
                
                if (isSelected) {
                    ingredientEl.classList.add('selected');
                }
                
                if (ingredient.price > 0) {
                    ingredientEl.classList.add('paid');
                }
                
                ingredientEl.dataset.id = ingredient.id;
                
                const icon = document.createElement('div');
                icon.className = 'ingredient-icon';
                icon.innerHTML = `
                    <svg viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="45" fill="${ingredient.color}" />
                        <text x="50" y="60" text-anchor="middle" font-size="30">${ingredient.icon}</text>
                    </svg>
                `;
                
                const name = document.createElement('div');
                name.className = 'ingredient-name';
                name.textContent = ingredient.name;
                
                ingredientEl.appendChild(icon);
                ingredientEl.appendChild(name);
                
                // å¦‚æœé£Ÿæéœ€è¦è´­ä¹°
                if (ingredient.price > 0) {
                    const priceEl = document.createElement('div');
                    priceEl.className = 'ingredient-price';
                    priceEl.textContent = `ğŸ’°${ingredient.price}`;
                    ingredientEl.appendChild(priceEl);
                    
                    const buyBtn = document.createElement('button');
                    buyBtn.className = 'buy-btn';
                    buyBtn.textContent = isOwned ? 'å·²æ‹¥æœ‰' : 'è´­ä¹°';
                    buyBtn.disabled = isOwned;
                    
                    if (!isOwned) {
                        buyBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            buyIngredient(ingredient);
                        });
                    }
                    
                    ingredientEl.appendChild(buyBtn);
                }
                
                ingredientsGrid.appendChild(ingredientEl);
            });
        }
        
        // è´­ä¹°é£Ÿæ
        function buyIngredient(ingredient) {
            if (gold >= ingredient.price) {
                gold -= ingredient.price;
                ownedIngredients.push(ingredient.id);
                
                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                localStorage.setItem('gold', gold);
                localStorage.setItem('ownedIngredients', JSON.stringify(ownedIngredients));
                
                // æ›´æ–°æ˜¾ç¤º
                updateGoldDisplay();
                renderIngredients();
                showNotification(`æˆåŠŸè´­ä¹° ${ingredient.name}ï¼`);
            } else {
                showNotification('é‡‘å¸ä¸è¶³ï¼', true);
            }
        }
        
        // æ›´æ–°é‡‘å¸æ˜¾ç¤º
        function updateGoldDisplay() {
            goldAmount.textContent = gold;
        }
        
        // åˆ‡æ¢é£Ÿæé€‰æ‹©çŠ¶æ€
        function toggleIngredient(id) {
            const ingredient = ingredients.find(ing => ing.id === id);
            
            // æ£€æŸ¥æ˜¯å¦æ‹¥æœ‰è¯¥é£Ÿæ
            if (!ownedIngredients.includes(id) && ingredient.price > 0) {
                showNotification('è¯·å…ˆè´­ä¹°æ­¤é£Ÿæï¼', true);
                return;
            }
            
            const index = selectedIngredients.findIndex(ing => ing.id === id);
            
            if (index === -1) {
                // æ·»åŠ é£Ÿæ
                selectedIngredients.push(ingredient);
                addIngredientToPot(ingredient);
            } else {
                // ç§»é™¤é£Ÿæ
                selectedIngredients.splice(index, 1);
                renderPotContent();
            }
            
            updateIngredientUI();
            updateCookButton();
        }
        
        // å°†é£Ÿææ·»åŠ åˆ°é”…ä¸­
        function addIngredientToPot(ingredient) {
            const potIngredient = document.createElement('div');
            potIngredient.className = 'ingredient-in-pot';
            potIngredient.dataset.id = ingredient.id;
            potIngredient.innerHTML = `
                <svg viewBox="0 0 30 30">
                    <circle cx="15" cy="15" r="12" fill="${ingredient.color}" />
                    <text x="15" y="20" text-anchor="middle" font-size="16">${ingredient.icon}</text>
                </svg>
            `;
            
            potContent.appendChild(potIngredient);
        }
        
        // é‡æ–°æ¸²æŸ“é”…ä¸­çš„å†…å®¹
        function renderPotContent() {
            potContent.innerHTML = '';
            selectedIngredients.forEach(ingredient => {
                addIngredientToPot(ingredient);
            });
        }
        
        // æ›´æ–°é£ŸæUIçŠ¶æ€
        function updateIngredientUI() {
            document.querySelectorAll('.ingredient-item').forEach(item => {
                const id = item.dataset.id;
                const isOwned = ownedIngredients.includes(id);
                
                if (selectedIngredients.some(ing => ing.id === id) && isOwned) {
                    item.classList.add('selected');
                } else {
                    item.classList.remove('selected');
                }
            });
        }
        
        // æ›´æ–°çƒ¹é¥ªæŒ‰é’®çŠ¶æ€
        function updateCookButton() {
            // æ£€æŸ¥æ˜¯å¦æœ‰æœªè´­ä¹°çš„é£Ÿæ
            const hasUnownedIngredient = selectedIngredients.some(ing => 
                !ownedIngredients.includes(ing.id) && ingredients.find(i => i.id === ing.id).price > 0
            );
            
            cookBtn.disabled = selectedIngredients.length === 0 || hasUnownedIngredient;
            
            if (hasUnownedIngredient) {
                cookBtn.textContent = 'è¯·å…ˆè´­ä¹°é£Ÿæ';
            } else {
                cookBtn.textContent = 'å®Œæˆçƒ¹é¥ª';
            }
        }
        
        // æ¸…ç©ºé”…å­
        function clearPot() {
            selectedIngredients = [];
            renderPotContent();
            updateIngredientUI();
            updateCookButton();
        }
        
        // çƒ¹é¥ªåŠ¨ç”»
        function startCooking() {
            if (selectedIngredients.length === 0) return;
            
            cookBtn.disabled = true;
            cookBtn.textContent = 'çƒ¹é¥ªä¸­...';
            
            const pot = document.getElementById('cookingPot');
            pot.style.animation = 'shake 1s ease-in-out';
            
            setTimeout(() => {
                pot.style.animation = '';
                cookBtn.textContent = 'å®Œæˆçƒ¹é¥ª';
                showNotification('çƒ¹é¥ªå®Œæˆï¼ç°åœ¨å¯ä»¥ç»™é¡¾å®¢äº†');
                prepareServingArea();
            }, 1000);
        }
        
        // è®¾ç½®åŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
            
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }
            
            .fade-in {
                animation: fadeIn 0.5s ease forwards;
            }
        `;
        document.head.appendChild(style);
        
        // å‡†å¤‡ä¸ŠèœåŒºåŸŸ
        function prepareServingArea() {
            currentDish = [...selectedIngredients];
            
            servingArea.innerHTML = `
                <p style="margin-bottom: 15px; color: #666;">è¯·å°†è¿™é“èœç«¯ç»™é¡¾å®¢ï¼</p>
                <div class="dish-plate">
                    <div class="dish-content" id="dishContent">
                        <!-- èœè‚´å†…å®¹å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                    </div>
                </div>
                <button class="btn btn-serve" id="serveBtn">ä¸Šèœ</button>
            `;
            
            const dishContent = document.getElementById('dishContent');
            const serveBtn = document.getElementById('serveBtn');
            
            // æ¸²æŸ“èœè‚´å†…å®¹
            selectedIngredients.forEach(ingredient => {
                const dishIngredient = document.createElement('div');
                dishIngredient.innerHTML = `
                    <svg viewBox="0 0 20 20" style="width: 20px; height: 20px;">
                        <circle cx="10" cy="10" r="9" fill="${ingredient.color}" />
                        <text x="10" y="14" text-anchor="middle" font-size="10">${ingredient.icon}</text>
                    </svg>
                `;
                dishContent.appendChild(dishIngredient);
            });
            
            serveBtn.addEventListener('click', serveToCustomer);
        }
        
        // ä¸ºé¡¾å®¢ä¸Šèœ
        function serveToCustomer() {
            const customer = customerTypes[Math.floor(Math.random() * customerTypes.length)];
            let score = 0;
            let earnings = 0;
            let comment = '';
            let bonus = 0;
            
            // è®¡ç®—å¾—åˆ†
            if (selectedIngredients.length === 0) {
                score = 1;
                comment = 'è¿™æ˜¯ä»€ä¹ˆï¼Ÿç©ºçš„ç›˜å­å—ï¼Ÿ';
            } else if (customer.highExpectation && selectedIngredients.length < 3) {
                score = 2;
                comment = 'è¿™å¤ªç®€å•äº†ï¼Œæˆ‘è¿˜æœŸå¾…æ›´å¥½çš„æ–™ç†ã€‚';
            } else {
                // æ£€æŸ¥æ˜¯å¦ç¬¦åˆé¡¾å®¢åå¥½
                const matchedIngredients = selectedIngredients.filter(ing => 
                    customer.preferences.includes(ing.id)
                ).length;
                
                if (customer.preferences.length > 0) {
                    const matchRatio = matchedIngredients / customer.preferences.length;
                    score = Math.ceil(1 + matchRatio * 4);
                    
                    if (score >= 4) {
                        comment = 'å¤ªç¾å‘³äº†ï¼ä½ å¾ˆæ‡‚æˆ‘å–œæ¬¢çš„å£å‘³ï¼';
                    } else if (score === 3) {
                        comment = 'è¿˜ä¸é”™ï¼Œä½†è¿˜ä¸å¤Ÿå¥½ã€‚';
                    } else {
                        comment = 'è¿™ä¸æ˜¯æˆ‘æƒ³è¦çš„é£æ ¼ã€‚';
                    }
                } else {
                    // æ™®é€šé¡¾å®¢ï¼Œæ ¹æ®é£Ÿæå¤šæ ·æ€§è¯„åˆ†
                    const uniqueIngredients = new Set(selectedIngredients.map(ing => ing.id)).size;
                    score = Math.min(5, Math.ceil(uniqueIngredients / 2));
                    
                    if (score >= 4) {
                        comment = 'å“‡ï¼è¿™é“èœçœŸæ£’ï¼';
                    } else if (score === 3) {
                        comment = 'å‘³é“è¿˜å¯ä»¥ã€‚';
                    } else {
                        comment = 'å¥½åƒå°‘äº†ç‚¹ä»€ä¹ˆ...';
                    }
                }
            }
            
            // è®¡ç®—æ”¶ç›Š
            earnings = score * 10;
            
            // æ£€æŸ¥æ˜¯å¦è·å¾—å¥–åŠ±
            if (score >= customer.bonusThreshold) {
                bonus = 10;
            }
            
            // æ›´æ–°é¤å…ç»Ÿè®¡
            restaurantStats.totalEarnings += earnings + bonus;
            restaurantStats.totalRating += score;
            restaurantStats.customersServed += 1;
            
            // æ›´æ–°é‡‘å¸
            gold += earnings + bonus;
            
            // ä¿å­˜æ•°æ®
            localStorage.setItem('restaurantStats', JSON.stringify(restaurantStats));
            localStorage.setItem('gold', gold);
            
            // æ˜¾ç¤ºé¡¾å®¢ååº”
            customerArea.style.display = 'block';
            customerMessage.textContent = customer.message;
            
            // æ˜¾ç¤ºè¯„åˆ†
            customerRating.innerHTML = '';
            for (let i = 1; i <= 5; i++) {
                const star = document.createElement('span');
                star.className = 'star';
                star.textContent = i <= score ? 'â˜…' : 'â˜†';
                star.style.color = i <= score ? '#ffc107' : '#ddd';
                customerRating.appendChild(star);
            }
            
            customerComment.textContent = comment;
            earningsValue.textContent = earnings;
            
            // æ˜¾ç¤ºå¥–åŠ±
            if (bonus > 0) {
                bonusEarnings.style.display = 'block';
                bonusValue.textContent = `+${bonus}`;
            } else {
                bonusEarnings.style.display = 'none';
            }
            
            // æ·»åŠ æ·¡å…¥åŠ¨ç”»
            customerArea.classList.add('fade-in');
            
            // æ»šåŠ¨åˆ°é¡¾å®¢åŒºåŸŸ
            customerArea.scrollIntoView({ behavior: 'smooth' });
            
            // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
            updateStats();
            updateGoldDisplay();
            
            // éšè—ä¸ŠèœåŒºåŸŸ
            servingArea.style.display = 'none';
        }
        
        // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
        function updateStats() {
            totalEarnings.textContent = restaurantStats.totalEarnings;
            
            const avgScore = restaurantStats.customersServed > 0
                ? (restaurantStats.totalRating / restaurantStats.customersServed).toFixed(1)
                : 0;
            avgRating.textContent = avgScore;
            
            customersServed.textContent = restaurantStats.customersServed;
        }
        
        // ä¸‹ä¸€ä½é¡¾å®¢
        function nextCustomer() {
            customerArea.style.display = 'none';
            customerArea.classList.remove('fade-in');
            
            servingArea.style.display = 'block';
            servingArea.innerHTML = `
                <p style="margin-bottom: 15px; color: #666;">çƒ¹é¥ªå®Œæˆåï¼Œä¸ºé¡¾å®¢æä¾›æ‚¨çš„ç¾é£Ÿï¼</p>
                <div style="text-align: center;">
                    <svg width="60" height="60" viewBox="0 0 100 100">
                        <circle cx="50" cy="45" r="30" fill="#ffccbc" />
                        <circle cx="40" cy="40" r="3" fill="#333" />
                        <circle cx="60" cy="40" r="3" fill="#333" />
                        <path d="M 40 55 Q 50 65 60 55" stroke="#333" stroke-width="2" fill="none" />
                        <ellipse cx="50" cy="80" rx="25" ry="35" fill="#4fc3f7" style="opacity: 0" id="customerWait" />
                    </svg>
                </div>
                <p style="margin-top: 15px; color: #666;">é¡¾å®¢æ­£åœ¨ç­‰å¾…...</p>
            `;
            
            // æ¨¡æ‹Ÿé¡¾å®¢ç­‰å¾…
            setTimeout(() => {
                const customerWait = document.getElementById('customerWait');
                if (customerWait) {
                    customerWait.style.transition = 'opacity 1s';
                    customerWait.style.opacity = '1';
                }
            }, 500);
        }
        
        // æ›´æ–°ä¿å­˜æŒ‰é’®çŠ¶æ€
        function updateSaveButton() {
            saveBtn.disabled = selectedIngredients.length === 0 || !recipeNameInput.value.trim() || currentRating === 0;
        }
        
        // è®¾ç½®è¯„åˆ†
        function setRating(rating) {
            currentRating = rating;
            ratingStars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
            ratingValue.textContent = `${rating}/5`;
            updateSaveButton();
        }
        
        // ä¿å­˜é£Ÿè°±
        function saveRecipe() {
            const recipeName = recipeNameInput.value.trim();
            
            if (!recipeName || !selectedIngredients.length || currentRating === 0) {
                return;
            }
            
            const recipe = {
                id: Date.now(),
                name: recipeName,
                ingredients: [...selectedIngredients],
                rating: currentRating,
                date: new Date().toLocaleDateString('zh-CN')
            };
            
            savedRecipes.push(recipe);
            localStorage.setItem('savedRecipes', JSON.stringify(savedRecipes));
            
            // é‡ç½®è¡¨å•
            clearPot();
            recipeNameInput.value = '';
            setRating(0);
            
            // æ›´æ–°æ˜¾ç¤º
            loadSavedRecipes();
            showNotification('é£Ÿè°±ä¿å­˜æˆåŠŸï¼');
            updateSaveButton();
        }
        
        // åŠ è½½å·²ä¿å­˜çš„é£Ÿè°±
        function loadSavedRecipes() {
            recipeList.innerHTML = '';
            
            if (savedRecipes.length === 0) {
                recipeList.innerHTML = '<p style="text-align: center; color: #999;">è¿˜æ²¡æœ‰ä¿å­˜çš„é£Ÿè°±</p>';
                return;
            }
            
            savedRecipes.forEach(recipe => {
                const recipeEl = document.createElement('div');
                recipeEl.className = 'recipe-item';
                recipeEl.dataset.id = recipe.id;
                
                // ç”Ÿæˆé£Ÿè°±SVG
                let ingredientsSVG = '';
                recipe.ingredients.slice(0, 4).forEach((ingredient, index) => {
                    ingredientsSVG += `
                        <circle cx="${15 + index * 15}" cy="30" r="8" fill="${ingredient.color}" />
                        <text x="${15 + index * 15}" y="35" text-anchor="middle" font-size="8">${ingredient.icon}</text>
                    `;
                });
                
                recipeEl.innerHTML = `
                    <div class="recipe-icon">
                        <svg viewBox="0 0 60 60">
                            <circle cx="30" cy="30" r="28" fill="white" stroke="#e0e0e0" stroke-width="2" />
                            ${ingredientsSVG}
                        </svg>
                    </div>
                    <div class="recipe-name">${recipe.name}</div>
                    <div class="recipe-rating">${'â˜…'.repeat(recipe.rating)}${'â˜†'.repeat(5 - recipe.rating)}</div>
                `;
                
                recipeEl.addEventListener('click', () => showRecipeDetails(recipe));
                recipeList.appendChild(recipeEl);
            });
        }
        
        // æ˜¾ç¤ºé£Ÿè°±è¯¦æƒ…
        function showRecipeDetails(recipe) {
            recipeDetails.innerHTML = `
                <h3>${recipe.name}</h3>
                <div class="recipe-rating">è¯„åˆ†: ${'â˜…'.repeat(recipe.rating)}${'â˜†'.repeat(5 - recipe.rating)} (${recipe.rating}/5)</div>
                <div class="recipe-ingredients">
                    <p><strong>é£Ÿæ:</strong></p>
                    ${recipe.ingredients.map(ing => {
                        const ingredient = ingredients.find(i => i.id === ing.id);
                        const priceText = ingredient.price > 0 ? ` (ğŸ’°${ingredient.price})` : '';
                        return `<span class="ingredient-tag">${ing.icon} ${ing.name}${priceText}</span>`;
                    }).join('')}
                </div>
                <div style="margin-top: 20px;">
                    <p><strong>åˆ›å»ºæ—¥æœŸ:</strong> ${recipe.date}</p>
                </div>
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn btn-cook" onclick="loadRecipe(${recipe.id})">é‡æ–°åˆ¶ä½œ</button>
                </div>
            `;
            
            recipeModal.style.display = 'flex';
        }
        
        // åŠ è½½é£Ÿè°±åˆ°çƒ¹é¥ªåŒº
        function loadRecipe(recipeId) {
            const recipe = savedRecipes.find(r => r.id === recipeId);
            if (!recipe) return;
            
            clearPot();
            selectedIngredients = [...recipe.ingredients];
            
            // æ£€æŸ¥æ˜¯å¦æœ‰æœªè´­ä¹°çš„é£Ÿæ
            recipe.ingredients.forEach(ingredient => {
                const ingredientData = ingredients.find(i => i.id === ingredient.id);
                if (ingredientData.price > 0 && !ownedIngredients.includes(ingredient.id)) {
                    showNotification(`è¯·å…ˆè´­ä¹° ${ingredient.name}ï¼`, true);
                }
            });
            
            renderPotContent();
            updateIngredientUI();
            
            recipeModal.style.display = 'none';
            
            // æ»šåŠ¨åˆ°çƒ¹é¥ªåŒº
            document.querySelector('.cooking-area').scrollIntoView({ behavior: 'smooth' });
        }
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, isError = false) {
            notification.textContent = message;
            notification.style.background = isError ? '#f44336' : '#4caf50';
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // å¼€å§‹çƒ¹é¥ªæ¯”èµ›
        function startCompetition() {
            if (competitionInProgress) return;
            
            competitionInProgress = true;
            startCompetitionBtn.disabled = true;
            startCompetitionBtn.textContent = 'æ¯”èµ›è¿›è¡Œä¸­...';
            
            // éšæœºé€‰æ‹©æ¯”èµ›ä¸»é¢˜
            const theme = competitionThemes[Math.floor(Math.random() * competitionThemes.length)];
            competitionTheme.textContent = theme.name;
            competitionRules.textContent = theme.rules;
            
            // æ˜¾ç¤ºæ¯”èµ›ä¿¡æ¯
            competitionInfo.style.display = 'block';
            competitionProgress.style.display = 'block';
            competitionTimerDisplay.style.display = 'block';
            competitionResults.style.display = 'none';
            
            // é‡ç½®è¿›åº¦æ¡
            progressBar.style.width = '0%';
            
            // å¼€å§‹å€’è®¡æ—¶
            let timeLeft = 40;
            competitionTimerDisplay.textContent = `æ¯”èµ›æ—¶é—´ï¼š${timeLeft}ç§’`;
            
            competitionTimer = setInterval(() => {
                timeLeft--;
                competitionTimerDisplay.textContent = `æ¯”èµ›æ—¶é—´ï¼š${timeLeft}ç§’`;
                
                // æ›´æ–°è¿›åº¦æ¡
                const progress = ((60 - timeLeft) / 60) * 100;
                progressBar.style.width = `${progress}%`;
                
                if (timeLeft <= 0) {
                    endCompetition(theme);
                }
            }, 1000);
            
            // æ»šåŠ¨åˆ°æ¯”èµ›åŒºåŸŸ
            document.querySelector('.competition-section').scrollIntoView({ behavior: 'smooth' });
        }
        
        // ç»“æŸæ¯”èµ›
        function endCompetition(theme) {
            clearInterval(competitionTimer);
            competitionInProgress = false;
            
            // æ˜¾ç¤ºç»“æœ
            showCompetitionResults(theme);
        }
        
        // æ˜¾ç¤ºæ¯”èµ›ç»“æœ
        function showCompetitionResults(theme) {
            // éšè—æ¯”èµ›ä¿¡æ¯
            competitionInfo.style.display = 'none';
            competitionProgress.style.display = 'none';
            competitionTimerDisplay.style.display = 'none';
            
            // è®¡ç®—ç©å®¶å¾—åˆ†
            let playerScore = calculateCompetitionScore(selectedIngredients, theme);
            
            // ç”ŸæˆAIå¨å¸ˆå¾—åˆ†
            const aiScores = aiChefs.map(chef => {
                let aiScore = Math.floor(Math.random() * 20) + 60; // 60-80åˆ†ä¹‹é—´çš„éšæœºåˆ†æ•°
                if (theme.scoreMultiplier) {
                    aiScore = Math.min(100, Math.floor(aiScore * theme.scoreMultiplier));
                }
                return {
                    name: chef.name,
                    avatar: chef.avatar,
                    score: aiScore
                };
            });
            
            // æ·»åŠ ç©å®¶å¾—åˆ†
            aiScores.push({
                name: 'ä½ ',
                avatar: 'ğŸ‘¨â€ğŸ³',
                score: playerScore,
                isPlayer: true
            });
            
            // æ’åºå¾—åˆ†
            aiScores.sort((a, b) => b.score - a.score);
            
            // æ˜¾ç¤ºç»“æœ
            competitionResults.style.display = 'block';
            resultsContainer.innerHTML = '';
            
            aiScores.forEach((result, index) => {
                const resultCard = document.createElement('div');
                resultCard.className = 'result-card';
                if (result.isPlayer) {
                    resultCard.style.background = index === 0 ? '#e8f5e9' : '#fff3e0';
                    resultCard.style.border = index === 0 ? '2px solid #4caf50' : '2px solid #ff9800';
                }
                
                resultCard.innerHTML = `
                    <div class="result-player">
                        <div class="result-avatar" style="background: ${result.isPlayer ? (index === 0 ? '#c8e6c9' : '#ffe0b2') : '#f5f5f5'}">
                            ${result.avatar}
                        </div>
                        <div class="result-info">
                            <div class="result-name">${result.name} ${result.isPlayer && index === 0 ? 'ğŸ†' : ''}</div>
                            <div class="result-score">${result.isPlayer ? 'ä½ çš„å¾—åˆ†' : 'AIå¾—åˆ†'}</div>
                        </div>
                    </div>
                    <div class="result-points">${result.score}åˆ†</div>
                `;
                
                resultsContainer.appendChild(resultCard);
            });
            
            // æ˜¾ç¤ºå¥–çŠ¶ï¼ˆå¦‚æœè·èƒœï¼‰
            if (playerScore === Math.max(...aiScores.map(r => r.score))) {
                setTimeout(() => {
                    showCertificate();
                }, 1500);
            } else {
                // æ˜¾ç¤ºå¤±è´¥ä¿¡æ¯
                const noCertificate = document.createElement('div');
                noCertificate.style.textAlign = 'center';
                noCertificate.style.padding = '20px';
                noCertificate.style.color = '#666';
                noCertificate.innerHTML = `
                    <p>å¾ˆé—æ†¾ï¼Œè¿™æ¬¡æ²¡æœ‰è·å¾—ç¬¬ä¸€åã€‚</p>
                    <p>å†æ¥å†å‰ï¼Œä¸‹æ¬¡ä¸€å®šå¯ä»¥è·èƒœï¼</p>
                `;
                resultsContainer.appendChild(noCertificate);
            }
            
            // é‡ç½®æŒ‰é’®
            startCompetitionBtn.disabled = false;
            startCompetitionBtn.textContent = 'å†æ¬¡æ¯”èµ›';
            
            // é‡ç½®é”…å­
            clearPot();
        }
        
        // è®¡ç®—æ¯”èµ›å¾—åˆ†
        function calculateCompetitionScore(ingredients, theme) {
            let score = 0;
            
            // åŸºç¡€åˆ†ï¼šé£Ÿææ•°é‡å’Œå¤šæ ·æ€§
            const uniqueIngredients = new Set(ingredients.map(ing => ing.id)).size;
            score += uniqueIngredients * 10;
            
            // æ£€æŸ¥ç‰¹æ®Šè¦æ±‚
            if (theme.requiredIngredients.length > 0) {
                const requiredCount = theme.requiredIngredients.filter(id => 
                    ingredients.some(ing => ing.id === id)
                ).length;
                score += requiredCount * 15;
            }
            
            if (theme.minIngredients && ingredients.length >= theme.minIngredients) {
                score += 20;
            }
            
            if (theme.maxCost) {
                const totalCost = ingredients.reduce((sum, ing) => {
                    const ingredient = ingredients.find(i => i.id === ing.id);
                    return sum + (ingredient ? ingredient.price : 0);
                }, 0);
                
                if (totalCost <= theme.maxCost) {
                    score += 25;
                } else {
                    score -= (totalCost - theme.maxCost) / 2;
                }
            }
            
            // åº”ç”¨å€æ•°åŠ æˆ
            if (theme.scoreMultiplier) {
                score = Math.min(100, Math.floor(score * theme.scoreMultiplier));
            }
            
            // éšæœºè°ƒæ•´
            score += Math.floor(Math.random() * 11) - 5; // -5åˆ°+5çš„éšæœºè°ƒæ•´
            
            return Math.max(0, Math.min(100, score)); // ç¡®ä¿åˆ†æ•°åœ¨0-100ä¹‹é—´
        }
        
        // æ˜¾ç¤ºå¥–çŠ¶
        function showCertificate() {
            certificate.style.display = 'block';
            certificateRestaurant.textContent = `"${restaurantName}"`;
            certificateDate.textContent = new Date().toLocaleDateString('zh-CN');
            
            // åˆ›å»ºæ–°å¥–çŠ¶
            const newCertificate = {
                id: Date.now(),
                restaurant: restaurantName,
                date: new Date().toISOString(),
                competitionTheme: competitionTheme.textContent,
                timestamp: Date.now()
            };
            
            // ä¿å­˜å¥–çŠ¶
            certificates.push(newCertificate);
            localStorage.setItem('certificates', JSON.stringify(certificates));
            
            // æ›´æ–°å¥–çŠ¶å¢™
            loadCertificateWall();
            
            // æ˜¾ç¤ºè·å¥–é€šçŸ¥
            setTimeout(() => {
                showNotification('ğŸ† æ­å–œè·å¾—å¥–çŠ¶ï¼');
            }, 1000);
        }
        
        // åŠ è½½å¥–çŠ¶å¢™
        function loadCertificateWall() {
            certificateGrid.innerHTML = '';
            
            // æ›´æ–°å¥–çŠ¶æ•°é‡
            certificateCount.textContent = `${certificates.length}ä¸ªå¥–çŠ¶`;
            
            if (certificates.length === 0) {
                certificateGrid.innerHTML = '<div class="empty-wall">è¿˜æ²¡æœ‰è·å¾—ä»»ä½•å¥–çŠ¶ï¼Œå¿«å»å‚åŠ æ¯”èµ›å§ï¼</div>';
                return;
            }
            
            // æ˜¾ç¤ºå¥–çŠ¶
            certificates.slice().reverse().forEach(certificate => {
                const certificateItem = document.createElement('div');
                certificateItem.className = 'certificate-item';
                
                const date = new Date(certificate.date);
                const formattedDate = `${date.getFullYear()}å¹´${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥`;
                
                certificateItem.innerHTML = `
                    <div class="certificate-preview">
                        <div class="certificate-restaurant">${certificate.restaurant}</div>
                        <div class="certificate-theme">${certificate.competitionTheme}</div>
                        <div class="certificate-date">${formattedDate}</div>
                    </div>
                `;
                
                certificateItem.addEventListener('click', () => {
                    showCertificateModal(certificate);
                });
                
                certificateGrid.appendChild(certificateItem);
            });
        }
        
        // æ˜¾ç¤ºå¥–çŠ¶è¯¦æƒ…
        function showCertificateModal(certificate) {
            const date = new Date(certificate.date);
            const formattedDate = `${date.getFullYear()}å¹´${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥`;
            
            certificateModalRestaurant.textContent = `"${certificate.restaurant}"`;
            certificateModalDate.textContent = `${formattedDate} Â· ${certificate.competitionTheme}`;
            
            certificateModal.style.display = 'flex';
            
            // æ»šåŠ¨åˆ°å¥–çŠ¶ä¸­å¿ƒ
            setTimeout(() => {
                certificateModalContent.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }
        
        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            clearBtn.addEventListener('click', clearPot);
            cookBtn.addEventListener('click', startCooking);
            saveBtn.addEventListener('click', saveRecipe);
            startCompetitionBtn.addEventListener('click', startCompetition);
            
            restaurantNameInput.addEventListener('blur', saveRestaurantName);
            restaurantNameInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    saveRestaurantName();
                }
            });
            
            ratingStars.forEach(star => {
                star.addEventListener('click', () => {
                    const rating = parseInt(star.dataset.rating);
                    setRating(rating);
                });
            });
            
            recipeNameInput.addEventListener('input', updateSaveButton);
            
            nextCustomerBtn.addEventListener('click', nextCustomer);
            
            closeModal.addEventListener('click', () => {
                recipeModal.style.display = 'none';
            });
            
            recipeModal.addEventListener('click', (e) => {
                if (e.target === recipeModal) {
                    recipeModal.style.display = 'none';
                }
            });
            
            closeModalCertificateModal.addEventListener('click', () => {
                certificateModal.style.display = 'none';
            });
            
            certificateModal.addEventListener('click', (e) => {
                if (e.target === certificateModal) {
                    certificateModal.style.display = 'none';
                }
            });
            
            // é˜²æ­¢ç§»åŠ¨ç«¯åŒå‡»ç¼©æ”¾
            let lastTouchEnd = 0;
            document.addEventListener('touchend', (event) => {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
        }
        
        // å¯åŠ¨æ¸¸æˆ
        init();
    </script>
</body>
</html>