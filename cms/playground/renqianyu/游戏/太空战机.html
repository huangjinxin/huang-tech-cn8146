<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>太空战机(鼠标控制版)</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            overflow: hidden;
            font-family: Arial, sans-serif;
            color: white;
            cursor: none;
        }
        #game-container {
            position: relative;
            width: 800px;
            height: 600px;
            margin: 20px auto;
            background: linear-gradient(to bottom, #001933, #000000);
            border: 2px solid #0066ff;
            box-shadow: 0 0 20px #0066ff;
            overflow: hidden;
        }
        #player {
            position: absolute;
            width: 50px;
            height: 50px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"><path d="M25 0 L50 25 L40 25 L40 50 L25 35 L10 50 L10 25 L0 25 Z" fill="%2344ccff"/></svg>');
            background-size: contain;
            z-index: 10;
            transform: translate(-50%, -50%);
        }
        .bullet {
            position: absolute;
            width: 5px;
            height: 15px;
            background-color: yellow;
            border-radius: 2px;
            box-shadow: 0 0 5px yellow;
            z-index: 5;
        }
        .enemy {
            position: absolute;
            width: 40px;
            height: 40px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><circle cx="20" cy="20" r="20" fill="%23cc0000"/><path d="M20 0 L40 20 L35 20 L35 40 L20 25 L5 40 L5 20 L0 20 Z" fill="%23440000"/></svg>');
            background-size: contain;
            z-index: 9;
        }
        .explosion {
            position: absolute;
            width: 60px;
            height: 60px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><circle cx="30" cy="30" r="30" fill="%23ff9900"/><circle cx="30" cy="30" r="20" fill="%23ff6600"/><circle cx="30" cy="30" r="10" fill="%23ff3300"/></svg>');
            background-size: contain;
            opacity: 0;
            z-index: 8;
            transition: opacity 0.3s, transform 0.5s;
        }
        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background-color: white;
            border-radius: 50%;
        }
        #score-display {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 20px;
            color: white;
            text-shadow: 0 0 5px #0066ff;
            z-index: 20;
        }
        #game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 100, 0.8);
            padding: 20px;
            border: 2px solid #0066ff;
            border-radius: 10px;
            text-align: center;
            display: none;
            z-index: 30;
        }
        #restart-btn {
            background-color: #0066ff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin-top: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        #restart-btn:hover {
            background-color: #0099ff;
        }
        #controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: #66ccff;
            font-size: 14px;
        }
        #mouse-cursor {
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid white;
            border-radius: 50%;
            pointer-events: none;
            z-index: 100;
            transform: translate(-50%, -50%);
            display: none;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="player"></div>
        <div id="mouse-cursor"></div>
        <div id="score-display">分数: 0</div>
        <div id="game-over">
            <h2>游戏结束!</h2>
            <p>你的最终分数: <span id="final-score">0</span></p>
            <button id="restart-btn">重新开始</button>
        </div>
        <div id="controls">
            鼠标: 移动战机 | 左键: 射击
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const gameContainer = document.getElementById('game-container');
            const player = document.getElementById('player');
            const mouseCursor = document.getElementById('mouse-cursor');
            const scoreDisplay = document.getElementById('score-display');
            const gameOverDisplay = document.getElementById('game-over');
            const finalScoreDisplay = document.getElementById('final-score');
            const restartBtn = document.getElementById('restart-btn');
            
            const containerWidth = gameContainer.clientWidth;
            const containerHeight = gameContainer.clientHeight;
            
            let score = 0;
            let gameRunning = true;
            let bullets = [];
            let enemies = [];
            let explosions = [];
            let mouseX = containerWidth / 2;
            let mouseY = containerHeight - 70;
            
            // 初始化玩家位置
            player.style.left = mouseX + 'px';
            player.style.top = mouseY + 'px';
            mouseCursor.style.left = mouseX + 'px';
            mouseCursor.style.top = mouseY + 'px';
            
            // 创建星星背景
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * containerWidth + 'px';
                star.style.top = Math.random() * containerHeight + 'px';
                gameContainer.appendChild(star);
            }
            
            // 鼠标移动事件
            gameContainer.addEventListener('mousemove', function(e) {
                const rect = gameContainer.getBoundingClientRect();
                mouseX = e.clientX - rect.left;
                mouseY = e.clientY - rect.top;
                
                // 限制在容器内
                mouseX = Math.max(25, Math.min(containerWidth - 25, mouseX));
                mouseY = Math.max(25, Math.min(containerHeight - 25, mouseY));
                
                if (gameRunning) {
                    player.style.left = mouseX + 'px';
                    player.style.top = mouseY + 'px';
                }
                
                mouseCursor.style.left = mouseX + 'px';
                mouseCursor.style.top = mouseY + 'px';
            });
            
            // 鼠标点击事件 - 发射子弹
            gameContainer.addEventListener('click', function() {
                if (gameRunning) {
                    fireBullet();
                }
            });
            
            // 鼠标进入容器时显示自定义指针
            gameContainer.addEventListener('mouseenter', function() {
                mouseCursor.style.display = 'block';
                document.body.style.cursor = 'none';
            });
            
            // 鼠标离开容器时恢复默认指针
            gameContainer.addEventListener('mouseleave', function() {
                mouseCursor.style.display = 'none';
                document.body.style.cursor = 'default';
            });
            
            // 重新开始游戏
            restartBtn.addEventListener('click', function() {
                resetGame();
                gameOverDisplay.style.display = 'none';
                gameRunning = true;
                
                // 重置鼠标位置
                mouseX = containerWidth / 2;
                mouseY = containerHeight - 70;
                player.style.left = mouseX + 'px';
                player.style.top = mouseY + 'px';
                mouseCursor.style.left = mouseX + 'px';
                mouseCursor.style.top = mouseY + 'px';
                
                gameLoop();
            });
            
            // 发射子弹
            function fireBullet() {
                const bullet = document.createElement('div');
                bullet.className = 'bullet';
                const playerRect = player.getBoundingClientRect();
                const gameRect = gameContainer.getBoundingClientRect();
                
                bullet.style.left = (playerRect.left - gameRect.left + 22) + 'px';
                bullet.style.top = (playerRect.top - gameRect.top - 10) + 'px';
                
                gameContainer.appendChild(bullet);
                bullets.push({
                    element: bullet,
                    x: playerRect.left - gameRect.left + 22,
                    y: playerRect.top - gameRect.top - 10
                });
            }
            
            // 自动射击功能（可选）
            let autoShootInterval;
            function startAutoShoot() {
                autoShootInterval = setInterval(() => {
                    if (gameRunning) {
                        fireBullet();
                    }
                }, 300);
            }
            
            function stopAutoShoot() {
                clearInterval(autoShootInterval);
            }
            
            // 创建敌人
            function spawnEnemy() {
                const enemyType = Math.random() > 0.3 ? 'small' : 'big';
                const enemySize = enemyType === 'small' ? 30 : 50;
                
                const enemy = document.createElement('div');
                enemy.className = 'enemy';
                enemy.style.width = enemySize + 'px';
                enemy.style.height = enemySize + 'px';
                
                const x = Math.random() * (containerWidth - enemySize);
                const y = -enemySize;
                
                enemy.style.left = x + 'px';
                enemy.style.top = y + 'px';
                
                gameContainer.appendChild(enemy);
                enemies.push({
                    element: enemy,
                    x: x,
                    y: y,
                    speed: 1 + Math.random() * 2,
                    size: enemySize,
                    value: enemyType === 'small' ? 10 : 5
                });
            }
            
            // 创建爆炸效果
            function createExplosion(x, y) {
                const explosion = document.createElement('div');
                explosion.className = 'explosion';
                explosion.style.left = (x - 30) + 'px';
                explosion.style.top = (y - 30) + 'px';
                
                gameContainer.appendChild(explosion);
                explosions.push({
                    element: explosion,
                    time: 0
                });
                
                // 短暂显示后移除
                setTimeout(() => {
                    explosion.style.opacity = '1';
                    explosion.style.transform = 'scale(1.5)';
                }, 10);
                
                setTimeout(() => {
                    explosion.remove();
                }, 500);
            }
            
            // 更新子弹位置
            function updateBullets() {
                for (let i = bullets.length - 1; i >= 0; i--) {
                    bullets[i].y -= 5;
                    bullets[i].element.style.top = bullets[i].y + 'px';
                    
                    // 检查子弹是否超出屏幕
                    if (bullets[i].y < -15) {
                        bullets[i].element.remove();
                        bullets.splice(i, 1);
                    }
                }
            }
            
            // 更新敌人位置
            function updateEnemies() {
                for (let i = enemies.length - 1; i >= 0; i--) {
                    enemies[i].y += enemies[i].speed;
                    enemies[i].element.style.top = enemies[i].y + 'px';
                    
                    // 检查敌人是否超出屏幕
                    if (enemies[i].y > containerHeight) {
                        enemies[i].element.remove();
                        enemies.splice(i, 1);
                    }
                }
            }
            
            // 检测碰撞
            function checkCollisions() {
                const playerRect = player.getBoundingClientRect();
                const gameRect = gameContainer.getBoundingClientRect();
                
                const playerX = playerRect.left - gameRect.left;
                const playerY = playerRect.top - gameRect.top;
                const playerSize = 50;
                
                // 检测子弹和敌人碰撞
                for (let i = bullets.length - 1; i >= 0; i--) {
                    for (let j = enemies.length - 1; j >= 0; j--) {
                        const bullet = bullets[i];
                        const enemy = enemies[j];
                        
                        if (bullet.x > enemy.x && 
                            bullet.x < enemy.x + enemy.size &&
                            bullet.y > enemy.y && 
                            bullet.y < enemy.y + enemy.size) {
                            
                            // 碰撞发生
                            createExplosion(enemy.x + enemy.size/2, enemy.y + enemy.size/2);
                            score += enemy.value;
                            scoreDisplay.textContent = '分数: ' + score;
                            
                            bullet.element.remove();
                            bullets.splice(i, 1);
                            
                            enemy.element.remove();
                            enemies.splice(j, 1);
                            
                            break;
                        }
                    }
                }
                
                // 检测玩家和敌人碰撞
                for (let i = enemies.length - 1; i >= 0; i--) {
                    const enemy = enemies[i];
                    
                    if (playerX < enemy.x + enemy.size &&
                        playerX + playerSize > enemy.x &&
                        playerY < enemy.y + enemy.size &&
                        playerY + playerSize > enemy.y) {
                        
                        // 游戏结束
                        gameRunning = false;
                        finalScoreDisplay.textContent = score;
                        gameOverDisplay.style.display = 'block';
                        
                        createExplosion(playerX + playerSize/2, playerY + playerSize/2);
                        player.style.display = 'none';
                        
                        enemy.element.remove();
                        enemies.splice(i, 1);
                        
                        break;
                    }
                }
            }
            
            // 重置游戏
            function resetGame() {
                // 清除所有子弹
                for (let bullet of bullets) {
                    bullet.element.remove();
                }
                bullets = [];
                
                // 清除所有敌人
                for (let enemy of enemies) {
                    enemy.element.remove();
                }
                enemies = [];
                
                // 重置玩家
                player.style.display = 'block';
                
                // 重置分数
                score = 0;
                scoreDisplay.textContent = '分数: 0';
            }
            
            // 游戏主循环
            function gameLoop() {
                if (!gameRunning) return;
                
                // 随机生成敌人
                if (Math.random() < 0.02) {
                    spawnEnemy();
                }
                
                // 更新游戏元素
                updateBullets();
                updateEnemies();
                checkCollisions();
                
                requestAnimationFrame(gameLoop);
            }
            
            // 开始游戏和自动射击
            startAutoShoot();
            gameLoop();
        });
    </script>
</body>
</html>