<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>åˆ†æ•°ä¹˜æ³•è¯¾å ‚å°å·¥å…·</title>
    <style>
        /* --------- åŸºç¡€å¸ƒå±€ ---------- */
        body{
            margin:0;
            padding:0;
            font-family:"Microsoft YaHei",Arial,sans-serif;
            background:#f4f8fb;
            color:#333;
        }
        header{
            background:#2c7be5;
            color:#fff;
            text-align:center;
            padding:1.5rem 0;
            font-size:2rem;
        }
        main{
            max-width:900px;
            margin:2rem auto;
            padding:0 1rem;
        }
        section{
            background:#fff;
            border-radius:8px;
            margin-bottom:1.5rem;
            box-shadow:0 2px 6px rgba(0,0,0,.1);
            padding:1.5rem;
        }
        h2{
            margin-top:0;
            color:#2c7be5;
        }
        /* --------- ç”µè„‘å½¢è±¡ ---------- */
        .computer{
            width:260px;
            margin:1rem auto;
            perspective:800px;
            cursor:pointer;
        }
        .monitor{
            width:100%;
            height:180px;
            background:#111;
            border-radius:6px 6px 2px 2px;
            position:relative;
            overflow:hidden;
            box-shadow:0 4px 8px rgba(0,0,0,.2);
        }
        .monitor::after{
            content:"";
            position:absolute;
            top:0; left:0;
            width:100%; height:100%;
            background:linear-gradient(135deg,rgba(255,255,255,.05),transparent);
        }
        .screen{
            position:absolute;
            top:12px; left:12px;
            right:12px; bottom:12px;
            background:#1e1e1e;
            border-radius:4px;
            display:flex;
            align-items:center;
            justify-content:center;
            color:#0f0;
            font-family:"Courier New",monospace;
            font-size:1.2rem;
            letter-spacing:2px;
        }
        .keyboard{
            width:100%;
            height:30px;
            background:#444;
            border-radius:0 0 6px 6px;
            margin-top:-4px;
            box-shadow:inset 0 2px 4px rgba(0,0,0,.5);
        }
        /* --------- è®¡ç®—å™¨å¼¹çª— ---------- */
        .modal{
            position:fixed;
            top:0; left:0;
            width:100%; height:100%;
            background:rgba(0,0,0,.5);
            display:none;
            align-items:center;
            justify-content:center;
            z-index:1000;
        }
        .modal-content{
            background:#fff;
            border-radius:8px;
            width:320px;
            padding:1.5rem;
            box-shadow:0 4px 12px rgba(0,0,0,.3);
        }
        .modal h3{
            margin-top:0;
            color:#2c7be5;
        }
        .input-group{
            display:flex;
            align-items:center;
            margin:0.8rem 0;
        }
        .input-group input{
            width:60px;
            padding:0.4rem;
            margin:0 0.2rem;
            text-align:center;
            border:1px solid #ccc;
            border-radius:4px;
        }
        .btn{
            background:#2c7be5;
            color:#fff;
            border:none;
            padding:0.6rem 1rem;
            border-radius:4px;
            cursor:pointer;
            transition:background .2s;
        }
        .btn:hover{
            background:#1a5bb8;
        }
        .result{
            margin-top:1rem;
            font-weight:bold;
            text-align:center;
        }
        /* --------- ç»ƒä¹ é¢˜ ---------- */
        .question{
            background:#fafafa;
            border:1px solid #e0e0e0;
            border-radius:6px;
            padding:1rem;
            margin-bottom:1rem;
        }
        .question p{
            margin:0 0 .5rem;
        }
        .question input{
            width:70px;
            padding:0.3rem;
            margin-right:0.3rem;
            text-align:center;
            border:1px solid #bbb;
            border-radius:4px;
        }
        .feedback{
            display:inline-block;
            margin-left:0.5rem;
            font-weight:bold;
        }
        .correct{color:#28a745;}
        .wrong{color:#dc3545;}
    </style>
</head>
<body>

<header>åˆ†æ•°ä¹˜æ³• Â· è¯¾å ‚äº’åŠ¨å°å·¥å…·</header>

<main>
    <!-- è¯´æ˜åŒº -->
    <section>
        <h2>ğŸ“š å­¦ä¹ ç›®æ ‡</h2>
        <ul>
            <li>äº†è§£åˆ†æ•°ä¹˜æ³•çš„å®šä¹‰ï¼š<strong>åˆ†å­ç›¸ä¹˜ã€åˆ†æ¯ç›¸ä¹˜</strong></li>
            <li>å­¦ä¼šåŒ–ç®€ç»“æœï¼ˆçº¦åˆ†ï¼‰</li>
            <li>æŒæ¡åˆ†æ•°ä¹˜æ³•åœ¨å®é™…æƒ…å¢ƒä¸­çš„åº”ç”¨</li>
        </ul>
    </section>

    <!-- ç”µè„‘å½¢è±¡ + è®¡ç®—å™¨å¼¹çª— -->
    <section>
        <h2>ğŸ’» â€œè®¡ç®—æœºâ€æ¥å¸®å¿™</h2>
        <div class="computer" id="computer">
            <div class="monitor">
                <div class="screen">FRACTION</div>
            </div>
            <div class="keyboard"></div>
        </div>
        <p style="text-align:center;color:#666;">ç‚¹å‡»ç”µè„‘ â†’ æ‰“å¼€åˆ†æ•°ä¹˜æ³•è®¡ç®—å™¨</p>

        <!-- å¼¹çª— -->
        <div class="modal" id="calcModal">
            <div class="modal-content">
                <h3>åˆ†æ•°ä¹˜æ³•è®¡ç®—å™¨</h3>
                <div class="input-group">
                    <label>åˆ†æ•°1ï¼š</label>
                    <input type="number" id="aNum" placeholder="åˆ†å­" min="0">
                    <span>/</span>
                    <input type="number" id="aDen" placeholder="åˆ†æ¯" min="1">
                </div>
                <div class="input-group">
                    <label>åˆ†æ•°2ï¼š</label>
                    <input type="number" id="bNum" placeholder="åˆ†å­" min="0">
                    <span>/</span>
                    <input type="number" id="bDen" placeholder="åˆ†æ¯" min="1">
                </div>
                <button class="btn" id="calcBtn">è®¡ç®—</button>
                <div class="result" id="calcResult"></div>
                <button class="btn" style="margin-top:0.8rem;background:#6c757d;" id="closeBtn">å…³é—­</button>
            </div>
        </div>
    </section>

    <!-- ç»ƒä¹ é¢˜åŒº -->
    <section>
        <h2>âœï¸ å®æˆ˜ç»ƒä¹ </h2>
        <div id="questionArea"></div>
        <button class="btn" id="newSetBtn">æ¢ä¸€ç»„æ–°é¢˜</button>
    </section>
</main>

<script>
    // ---------- å·¥å…·å‡½æ•° ----------
    function gcd(m, n) {
        return n ? gcd(n, m % n) : Math.abs(m);
    }
    function simplify(num, den) {
        const g = gcd(num, den);
        return [num / g, den / g];
    }
    function fractionToString(num, den) {
        if (den === 1) return `${num}`;
        return `${num}/${den}`;
    }

    // ---------- è®¡ç®—å™¨ ----------
    const computer = document.getElementById('computer');
    const modal = document.getElementById('calcModal');
    const closeBtn = document.getElementById('closeBtn');
    const calcBtn = document.getElementById('calcBtn');
    const resultDiv = document.getElementById('calcResult');

    computer.addEventListener('click', () => modal.style.display = 'flex');
    closeBtn.addEventListener('click', () => modal.style.display = 'none');

    calcBtn.addEventListener('click', () => {
        const aNum = parseInt(document.getElementById('aNum').value);
        const aDen = parseInt(document.getElementById('aDen').value);
        const bNum = parseInt(document.getElementById('bNum').value);
        const bDen = parseInt(document.getElementById('bDen').value);

        if (isNaN(aNum) || isNaN(aDen) || isNaN(bNum) || isNaN(bDen) ||
            aDen===0 || bDen===0) {
            resultDiv.innerHTML = '<span class="wrong">è¯·è¾“å…¥åˆæ³•çš„åˆ†æ•°ï¼ˆåˆ†æ¯ä¸èƒ½ä¸º0ï¼‰</span>';
            return;
        }

        const num = aNum * bNum;
        const den = aDen * bDen;
        const [sNum, sDen] = simplify(num, den);
        const origin = fractionToString(num, den);
        const simplified = fractionToString(sNum, sDen);
        resultDiv.innerHTML = `ç»“æœï¼š<strong>${origin}</strong> â†’ <strong>${simplified}</strong>`;
    });

    // ---------- ç»ƒä¹ é¢˜ ----------
    const questionArea = document.getElementById('questionArea');
    const newSetBtn = document.getElementById('newSetBtn');

    function randomInt(min, max){
        return Math.floor(Math.random()*(max-min+1))+min;
    }
    function genFraction(){
        const den = randomInt(2,9);
        const num = randomInt(1,den-1); // ä¿è¯çœŸåˆ†æ•°
        return [num, den];
    }
    function createQuestion(id){
        const [aNum,aDen] = genFraction();
        const [bNum,bDen] = genFraction();
        const trueNum = aNum * bNum;
        const trueDen = aDen * bDen;
        const [simpNum, simpDen] = simplify(trueNum,trueDen);
        const answerStr = fractionToString(simpNum,simpDen);

        const div = document.createElement('div');
        div.className = 'question';
        div.innerHTML = `
            <p>é¢˜ç›® ${id+1}ï¼š <strong>${aNum}/${aDen} Ã— ${bNum}/${bDen} = ?</strong></p>
            <input type="text" placeholder="ç­”æ¡ˆ(å¦‚ 3/4)" id="ans${id}">
            <button class="btn" style="font-size:0.9rem;" onclick="checkAnswer(${id},'${answerStr}')">æäº¤</button>
            <span class="feedback" id="feed${id}"></span>
        `;
        return div;
    }

    function renderSet(){
        questionArea.innerHTML = '';
        for(let i=0;i<3;i++){
            questionArea.appendChild(createQuestion(i));
        }
    }

    function checkAnswer(idx, correct){
        const userInput = document.getElementById(`ans${idx}`).value.trim();
        const feed = document.getElementById(`feed${idx}`);
        if(userInput === ''){
            feed.textContent = 'è¯·å¡«å†™ç­”æ¡ˆ';
            feed.className = 'feedback wrong';
            return;
        }
        // ç®€å•æ ‡å‡†åŒ–ï¼šå»æ‰ç©ºæ ¼ã€ç»Ÿä¸€åˆ†å­åˆ†æ¯é¡ºåº
        const norm = userInput.replace(/\s+/g,'');
        if(norm === correct){
            feed.textContent = 'âœ“ æ­£ç¡®';
            feed.className = 'feedback correct';
        }else{
            feed.textContent = `âœ— é”™è¯¯ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ ${correct}`;
            feed.className = 'feedback wrong';
        }
    }

    // æŠŠæ£€æŸ¥å‡½æ•°æŒ‚åˆ°å…¨å±€ï¼ˆå› ä¸ºå†…è” onclick éœ€è¦ï¼‰
    window.checkAnswer = checkAnswer;

    newSetBtn.addEventListener('click', renderSet);
    // åˆå§‹æ¸²æŸ“
    renderSet();
</script>
</body>
</html>