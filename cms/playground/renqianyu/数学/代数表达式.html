<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ä»£æ•°è¡¨è¾¾å¼ Â· äº¤äº’å­¦ä¹ å°ç«™</title>
    <style>
        :root {
            --primary:#4A90E2;
            --accent:#FF9800;
            --bg:#F5F7FA;
            --card:#FFFFFF;
            --text:#333333;
            --success:#4CAF50;
            --error:#F44336;
        }
        body{
            margin:0;
            font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;
            background:var(--bg);
            color:var(--text);
        }
        .container{
            max-width:960px;
            margin:0 auto;
            padding:20px;
        }
        h1{
            text-align:center;
            color:var(--primary);
            margin-bottom:30px;
        }
        .card{
            background:var(--card);
            border-radius:8px;
            box-shadow:0 4px 12px rgba(0,0,0,.08);
            margin-bottom:20px;
            overflow:hidden;
            transition:transform .2s;
        }
        .card:hover{
            transform:translateY(-3px);
        }
        .card-header{
            background:var(--primary);
            color:#fff;
            padding:12px 16px;
            cursor:pointer;
            user-select:none;
        }
        .card-body{
            padding:16px;
            display:none;
        }
        .card-body.show{
            display:block;
        }
        .example{
            background:#FAFAFA;
            border-left:4px solid var(--accent);
            margin:12px 0;
            padding:8px 12px;
            font-family:"Courier New",monospace;
        }
        .btn{
            background:var(--primary);
            color:#fff;
            border:none;
            border-radius:4px;
            padding:8px 12px;
            cursor:pointer;
            transition:background .2s;
        }
        .btn:hover{
            background:#357ABD;
        }
        .quiz-option{
            display:block;
            margin:6px 0;
        }
        .feedback{
            margin-top:8px;
            font-weight:bold;
        }
        .feedback.success{
            color:var(--success);
        }
        .feedback.error{
            color:var(--error);
        }
        .confetti{
            position:fixed;
            top:0;left:0;
            width:100%;
            height:100%;
            pointer-events:none;
            overflow:hidden;
        }
        .confetti span{
            position:absolute;
            width:6px;height:6px;
            background:#ff0;
            animation:fall 3s linear infinite;
        }
        @keyframes fall{
            0%{transform:translateY(-10px) rotate(0deg);}
            100%{transform:translateY(100vh) rotate(360deg);}
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ä»£æ•°è¡¨è¾¾å¼ äº’åŠ¨å­¦ä¹ å¡ç‰‡</h1>

        <!-- 1. æ¦‚å¿µå¡ç‰‡ -->
        <div class="card">
            <div class="card-header">ğŸ“š ä»€ä¹ˆæ˜¯ä»£æ•°è¡¨è¾¾å¼ï¼Ÿ</div>
            <div class="card-body">
                <p>ä»£æ•°è¡¨è¾¾å¼æ˜¯ç”±æ•°ã€å­—æ¯ï¼ˆç§°ä¸º**æœªçŸ¥æ•°æˆ–å˜é‡**ï¼‰ä»¥åŠè¿ç®—ç¬¦ï¼ˆ+ã€âˆ’ã€Ã—ã€Ã·ã€^ï¼‰ç»„æˆçš„å¼å­ã€‚</p>
                <p>ä¾‹å­ï¼š</p>
                <div class="example">3xÂ² + 5xy - 7</div>
                <p>å…¶ä¸­ï¼š</p>
                <ul>
                    <li><b>ç³»æ•°</b>ï¼šæ•°å­— 3ã€5ã€-7ã€‚</li>
                    <li><b>å˜é‡</b>ï¼šxã€yã€‚</li>
                    <li><b>æŒ‡æ•°</b>ï¼šxÂ² è¡¨ç¤º x çš„äºŒæ¬¡æ–¹ã€‚</li>
                </ul>
                <p>ä»£æ•°è¡¨è¾¾å¼å¯ä»¥è¿›è¡Œ<strong>åŒ–ç®€ã€åˆå¹¶åŒç±»é¡¹ã€å› å¼åˆ†è§£</strong>ç­‰è¿ç®—ã€‚</p>
            </div>
        </div>

        <!-- 2. ä»£æ•°è¡¨è¾¾å¼åŒ–ç®€ç»ƒä¹  -->
        <div class="card">
            <div class="card-header">ğŸ§© éšæœºåŒ–ç®€ç»ƒä¹ </div>
            <div class="card-body">
                <p>ç³»ç»Ÿä¼šéšæœºç”Ÿæˆä¸€ä¸ªéœ€è¦åˆå¹¶åŒç±»é¡¹çš„è¡¨è¾¾å¼ï¼Œè¾“å…¥ç­”æ¡ˆåç«‹å³å¾—åˆ°åé¦ˆã€‚</p>
                <div id="exercise" class="example"></div>
                <input type="text" id="answer" placeholder="åœ¨æ­¤è¾“å…¥åŒ–ç®€åçš„ç»“æœ" style="width:60%;padding:6px;">
                <button class="btn" id="checkBtn">æ£€æŸ¥ç­”æ¡ˆ</button>
                <div id="feedback" class="feedback"></div>
                <button class="btn" id="nextBtn" style="margin-top:8px;">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <!-- 3. å°æµ‹éªŒ -->
        <div class="card">
            <div class="card-header">â“ å°æµ‹éªŒï¼šé€‰æ‹©æ­£ç¡®çš„åŒ–ç®€ç»“æœ</div>
            <div class="card-body">
                <p id="quiz-question"></p>
                <div id="quiz-options"></div>
                <button class="btn" id="submitQuiz">æäº¤ç­”æ¡ˆ</button>
                <div id="quiz-feedback" class="feedback"></div>
            </div>
        </div>
    </div>

    <!-- å½©è›‹ï¼šç­”å¯¹åå‡ºç°çš„å½©çº¸ -->
    <div class="confetti" id="confetti"></div>

    <script>
        // ---------- å¡ç‰‡å±•å¼€/æ”¶èµ· ----------
        document.querySelectorAll('.card-header').forEach(header=>{
            header.addEventListener('click',()=> {
                const body = header.nextElementSibling;
                body.classList.toggle('show');
            });
        });

        // ---------- éšæœºç»ƒä¹  ----------
        const exerciseEl = document.getElementById('exercise');
        const answerEl   = document.getElementById('answer');
        const feedbackEl = document.getElementById('feedback');
        const checkBtn   = document.getElementById('checkBtn');
        const nextBtn    = document.getElementById('nextBtn');

        // ç”Ÿæˆéšæœºä»£æ•°å¼ï¼ˆä»…åˆå¹¶åŒç±»é¡¹ï¼‰
        function genExpression(){
            const vars = ['x','y','z'];
            const terms = [];
            const coeffRange = [-5,5];
            const termCount = Math.floor(Math.random()*4)+3; // 3~6 é¡¹

            for(let i=0;i<termCount;i++){
                const coeff = Math.floor(Math.random()* (coeffRange[1]-coeffRange[0]+1)) + coeffRange[0];
                if(coeff===0){ i--; continue; }
                const v = vars[Math.floor(Math.random()*vars.length)];
                const power = Math.floor(Math.random()*3); // 0~2 æ¬¡æ–¹
                const term = (coeff>0 && terms.length>0? '+' : '') + coeff + (power>0? v+'^'+power : v);
                terms.push(term);
            }
            return terms.join('');
        }

        // è®¡ç®—åŒ–ç®€ç»“æœï¼ˆåˆå¹¶åŒç±»é¡¹ï¼ŒæŒ‡æ•°ç›¸åŒè§†ä¸ºåŒç±»ï¼‰
        function simplify(expr){
            // ç®€å•å®ç°ï¼šæŠŠæ¯é¡¹åˆ†ç¦»ï¼Œç»Ÿè®¡ç³»æ•°
            const termMap = {};
            // æŠŠ - å˜æˆ + -ï¼Œæ–¹ä¾¿ split
            const safe = expr.replace(/-/g,'+-');
            const items = safe.split('+').filter(t=>t.trim()!=='');

            items.forEach(item=>{
                const match = item.match(/^(-?\d+)([a-z])(?:\^(\d+))?$/);
                if(!match) return;
                const coeff = Number(match[1]);
                const v = match[2];
                const p = match[3]? Number(match[3]) : 1;
                const key = v+'^'+p;
                termMap[key] = (termMap[key]||0)+coeff;
            });

            // ç”ŸæˆåŒ–ç®€åçš„å­—ç¬¦ä¸²
            const parts = [];
            for(const k in termMap){
                const c = termMap[k];
                if(c===0) continue;
                const [v,p] = k.split('^');
                const pow = Number(p);
                const varPart = pow===1? v : v+'^'+pow;
                parts.push((c>0 && parts.length>0? '+' : '')+c+varPart);
            }
            return parts.join('')||'0';
        }

        let currentExpr, currentAns;
        function newExercise(){
            currentExpr = genExpression();
            currentAns  = simplify(currentExpr);
            exerciseEl.textContent = currentExpr;
            answerEl.value = '';
            feedbackEl.textContent = '';
        }
        checkBtn.onclick = ()=>{
            const user = answerEl.value.replace(/\s+/g,'');
            if(user===currentAns){
                feedbackEl.textContent='âœ… æ­£ç¡®ï¼';
                feedbackEl.className='feedback success';
                triggerConfetti();
            }else{
                feedbackEl.textContent='âŒ é”™è¯¯ï¼Œæ­£ç¡®ç­”æ¡ˆä¸º: '+currentAns;
                feedbackEl.className='feedback error';
            }
        };
        nextBtn.onclick = newExercise;
        newExercise();

        // ---------- å°æµ‹éªŒ ----------
        const quizQuestionEl = document.getElementById('quiz-question');
        const quizOptionsEl  = document.getElementById('quiz-options');
        const submitQuizBtn  = document.getElementById('submitQuiz');
        const quizFeedbackEl = document.getElementById('quiz-feedback');

        const quizData = [
            {
                q:'åŒ–ç®€ 2x + 3x - 5',
                options:['5x - 5','-5+5x','5x+5','-5x+5'],
                a:0
            },
            {
                q:'åŒ–ç®€ -4y + 7y + y',
                options:['4y','-4y','-2y','-3y'],
                a:0
            },
            {
                q:'åŒ–ç®€ 3a^2 - a^2 + 2a',
                options:['2a^2 + 2a','3a^2 + 2a','2a^2 - 2a','2a^2'],
                a:0
            },
            {
                q:'åŒ–ç®€ 6m - 2m - 3m',
                options:['1m','3m','-1m','m'],
                a:1
            }
        ];

        function loadQuiz(){
            const item = quizData[Math.floor(Math.random()*quizData.length)];
            quizQuestionEl.textContent = item.q;
            quizOptionsEl.innerHTML = '';
            item.options.forEach((opt,i)=>{
                const id = 'opt'+i;
                const html = `<label class="quiz-option"><input type="radio" name="quiz" id="${id}" value="${i}"> ${opt}</label>`;
                quizOptionsEl.innerHTML += html;
            });
            submitQuizBtn.dataset.answer = item.a;
            quizFeedbackEl.textContent='';
        }

        submitQuizBtn.onclick = ()=>{
            const radios = document.getElementsByName('quiz');
            let selected = -1;
            radios.forEach(r=>{ if(r.checked) selected = Number(r.value); });
            if(selected===-1){
                quizFeedbackEl.textContent='è¯·é€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼';
                quizFeedbackEl.className='feedback error';
                return;
            }
            const correct = Number(submitQuizBtn.dataset.answer);
            if(selected===correct){
                quizFeedbackEl.textContent='ğŸŒŸ æ­£ç¡®ï¼Œæ­å–œï¼';
                quizFeedbackEl.className='feedback success';
                triggerConfetti();
            }else{
                quizFeedbackEl.textContent='â é”™è¯¯ï¼Œå†è¯•ä¸€æ¬¡ï¼';
                quizFeedbackEl.className='feedback error';
            }
            // 3 ç§’åè‡ªåŠ¨æ¢é¢˜
            setTimeout(loadQuiz,3000);
        };
        loadQuiz();

        // ---------- å½©çº¸åŠ¨ç”» ----------
        function triggerConfetti(){
            const container = document.getElementById('confetti');
            const colors = ['#FFEB3B','#FF9800','#E91E63','#4CAF50','#2196F3'];
            for(let i=0;i<80;i++){
                const span = document.createElement('span');
                span.style.background = colors[Math.floor(Math.random()*colors.length)];
                span.style.left = Math.random()*100 + 'vw';
                span.style.animationDelay = Math.random()*3 + 's';
                container.appendChild(span);
                // 2 ç§’åæ¸…é™¤
                setTimeout(()=>span.remove(),4000);
            }
        }
    </script>
</body>
</html>